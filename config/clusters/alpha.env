#!/bin/bash
# Cluster Configuration: alpha
# Test cluster template with -alpha suffix naming
#
# Source this file: source config/clusters/alpha.env

# =============================================================================
# Cluster Identity
# =============================================================================
CLUSTER_NAME="alpha"
PROTECTED="false"

# =============================================================================
# Storage
# =============================================================================
STORAGE_CLASS="microk8s-hostpath"

# =============================================================================
# Kubernetes Namespaces
# =============================================================================
GITLAB_NAMESPACE="gitlab-alpha"
JENKINS_NAMESPACE="jenkins-alpha"
NEXUS_NAMESPACE="nexus-alpha"
ARGOCD_NAMESPACE="argocd-alpha"
DEV_NAMESPACE="dev-alpha"
STAGE_NAMESPACE="stage-alpha"
PROD_NAMESPACE="prod-alpha"

# =============================================================================
# External Hostnames
# =============================================================================
GITLAB_HOST_EXTERNAL="gitlab-alpha.jmann.local"
JENKINS_HOST_EXTERNAL="jenkins-alpha.jmann.local"
NEXUS_HOST_EXTERNAL="nexus-alpha.jmann.local"
ARGOCD_HOST_EXTERNAL="argocd-alpha.jmann.local"
DOCKER_REGISTRY_HOST="docker-alpha.jmann.local"

# =============================================================================
# GitLab
# =============================================================================
GITLAB_HOST_INTERNAL="gitlab.${GITLAB_NAMESPACE}.svc.cluster.local"
GITLAB_GROUP="p2c"

GITLAB_URL_INTERNAL="http://${GITLAB_HOST_INTERNAL}"
GITLAB_URL_EXTERNAL="https://${GITLAB_HOST_EXTERNAL}"

# Secrets
GITLAB_API_TOKEN_SECRET="gitlab-api-token"
GITLAB_API_TOKEN_KEY="token"

# GitLab user credentials (for scripts that need username)
GITLAB_USER_SECRET="gitlab-admin-credentials"
GITLAB_USER_KEY="username"

# Repository names
APP_REPO_NAME="example-app"
APP_CUE_NAME="exampleApp"  # CUE/manifest name (camelCase)
DEPLOYMENTS_REPO_NAME="k8s-deployments"

# Repository paths
APP_REPO_PATH="${GITLAB_GROUP}/${APP_REPO_NAME}"
DEPLOYMENTS_REPO_PATH="${GITLAB_GROUP}/${DEPLOYMENTS_REPO_NAME}"

# Repository URLs (internal)
APP_REPO_URL="${GITLAB_URL_INTERNAL}/${APP_REPO_PATH}.git"
DEPLOYMENTS_REPO_URL="${GITLAB_URL_INTERNAL}/${DEPLOYMENTS_REPO_PATH}.git"

# Repository URLs (external)
APP_REPO_URL_EXTERNAL="${GITLAB_URL_EXTERNAL}/${APP_REPO_PATH}.git"
DEPLOYMENTS_REPO_URL_EXTERNAL="${GITLAB_URL_EXTERNAL}/${DEPLOYMENTS_REPO_PATH}.git"

# =============================================================================
# Jenkins
# =============================================================================
JENKINS_HOST_INTERNAL="jenkins.${JENKINS_NAMESPACE}.svc.cluster.local"

JENKINS_URL_INTERNAL="http://${JENKINS_HOST_INTERNAL}:8080"
JENKINS_URL_EXTERNAL="https://${JENKINS_HOST_EXTERNAL}"

# Secrets
JENKINS_ADMIN_SECRET="jenkins-admin-credentials"
JENKINS_ADMIN_USER_KEY="username"
JENKINS_ADMIN_TOKEN_KEY="password"

# Job paths (MultiBranch Pipeline format: "job-name/job/branch")
JENKINS_APP_JOB_PATH="${APP_REPO_NAME}/job/main"

# Promotion job
JENKINS_PROMOTE_JOB_NAME="promote-environment"
JENKINS_AUTO_PROMOTE_JOB_NAME="k8s-deployments-auto-promote"

# =============================================================================
# ArgoCD
# =============================================================================
ARGOCD_HOST_INTERNAL="argocd-server.${ARGOCD_NAMESPACE}.svc.cluster.local"

ARGOCD_URL_INTERNAL="http://${ARGOCD_HOST_INTERNAL}"
ARGOCD_URL_EXTERNAL="https://${ARGOCD_HOST_EXTERNAL}"

# =============================================================================
# Nexus / Docker Registry
# =============================================================================
NEXUS_HOST_INTERNAL="nexus.${NEXUS_NAMESPACE}.svc.cluster.local"

NEXUS_URL_INTERNAL="http://${NEXUS_HOST_INTERNAL}:8081"
NEXUS_URL_EXTERNAL="https://${NEXUS_HOST_EXTERNAL}"

# Docker registry (internal for pushing, external for pulling)
DOCKER_REGISTRY_INTERNAL="${NEXUS_HOST_INTERNAL}:5000"
DOCKER_REGISTRY_EXTERNAL="${DOCKER_REGISTRY_HOST}"

# Secrets
NEXUS_ADMIN_SECRET="nexus-admin-credentials"
NEXUS_ADMIN_USER_KEY="username"
NEXUS_ADMIN_PASSWORD_KEY="password"

# =============================================================================
# k8s-deployments Pipeline Configuration
# =============================================================================
K8S_DEPLOYMENTS_REPO_PATH="${DEPLOYMENTS_REPO_PATH}"
# Jenkins MultiBranch Pipeline job names (must match repo names)
K8S_DEPLOYMENTS_JOB="k8s-deployments"

# Timeouts (seconds)
K8S_DEPLOYMENTS_BUILD_TIMEOUT="${K8S_DEPLOYMENTS_BUILD_TIMEOUT:-300}"
PROMOTION_MR_TIMEOUT="${PROMOTION_MR_TIMEOUT:-180}"
